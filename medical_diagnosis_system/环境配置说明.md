# 环境配置文件说明

## 📁 文件位置

环境配置文件位于项目根目录：
```
/Users/a202308688/Downloads/sc/tuanpian/assets/medical_diagnosis_system/
├── .env                    # 环境配置文件（需要创建）
├── env_template.txt        # 环境配置模板
├── env_loader.py          # 环境变量加载器
├── start_with_env.py      # 带环境变量的启动脚本
└── 环境配置说明.md        # 本说明文档
```

## 🔧 创建环境配置文件

### 方法1：使用模板文件（推荐）
```bash
# 进入项目目录
cd /Users/a202308688/Downloads/sc/tuanpian/assets/medical_diagnosis_system/

# 从模板创建环境文件
cp env_template.txt .env

# 编辑配置文件
nano .env
# 或使用其他编辑器
code .env
```

### 方法2：手动创建
```bash
# 创建 .env 文件
touch .env

# 编辑文件内容
nano .env
```

## 📝 配置文件内容

### 基本配置
```bash
# AI API 配置
DASHSCOPE_API_KEY=sk-57a7c48444c74ccc8173024d9288e625
OPENAI_API_KEY=your-openai-api-key-here

# 服务配置
API_BASE_URL=http://127.0.0.1:8000
MODEL_TRAINING_URL=http://localhost:7003

# 端口配置
API_PORT=8000
FRONTEND_PORT=8501
MODEL_TRAINING_PORT=7003

# 系统配置
SYSTEM_NAME=医疗AI科研系统
VERSION=1.0.0
DEBUG=true
```

### 高级配置
```bash
# 数据库配置
DATABASE_PATH=medical_database.db

# 安全配置
ENABLE_CORS=true

# 日志配置
LOG_LEVEL=INFO
LOG_FILE=logs/system.log
```

## 🚀 使用方法

### 方法1：使用启动脚本（推荐）
```bash
# 进入项目目录
cd /Users/a202308688/Downloads/sc/tuanpian/assets/medical_diagnosis_system/

# 运行启动脚本
python start_with_env.py
```

### 方法2：手动设置环境变量
```bash
# 设置环境变量
export DASHSCOPE_API_KEY="sk-57a7c48444c74ccc8173024d9288e625"
export API_BASE_URL="http://127.0.0.1:8000"

# 启动服务
python main.py &
python mock_model_training.py &
streamlit run app_simple.py
```

### 方法3：在代码中加载
```python
from env_loader import env

# 获取配置
api_key = env.get('DASHSCOPE_API_KEY')
debug_mode = env.get_bool('DEBUG')
api_url = env.get('API_BASE_URL')
```

## 🔒 安全注意事项

### 1. 敏感信息保护
- ✅ 将 `.env` 文件添加到 `.gitignore`
- ✅ 不要将包含真实API密钥的 `.env` 文件提交到版本控制
- ✅ 生产环境使用环境变量而非文件

### 2. 文件权限
```bash
# 设置适当的文件权限
chmod 600 .env
```

### 3. 备份配置
```bash
# 备份配置文件
cp .env .env.backup
```

## 🛠️ 配置选项说明

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `DASHSCOPE_API_KEY` | string | - | 阿里云通义千问API密钥（必需） |
| `OPENAI_API_KEY` | string | - | OpenAI API密钥（可选） |
| `API_BASE_URL` | string | http://127.0.0.1:8000 | 后端API地址 |
| `MODEL_TRAINING_URL` | string | http://localhost:7003 | 模型训练服务地址 |
| `API_PORT` | int | 8000 | 后端API端口 |
| `FRONTEND_PORT` | int | 8501 | 前端端口 |
| `MODEL_TRAINING_PORT` | int | 7003 | 模型训练端口 |
| `DEBUG` | bool | true | 调试模式 |
| `ENABLE_CORS` | bool | true | 跨域请求支持 |
| `LOG_LEVEL` | string | INFO | 日志级别 |

## 🔍 故障排除

### 1. 环境文件未找到
```bash
# 检查文件是否存在
ls -la .env

# 从模板创建
cp env_template.txt .env
```

### 2. 环境变量未加载
```bash
# 检查环境变量
echo $DASHSCOPE_API_KEY

# 手动加载
source .env
```

### 3. 端口冲突
```bash
# 检查端口占用
lsof -i :8000
lsof -i :8501
lsof -i :7003

# 修改配置文件中的端口
```

## 📞 技术支持

如果遇到配置问题，请检查：
1. 文件路径是否正确
2. 文件权限是否适当
3. 配置格式是否正确
4. 端口是否被占用
5. API密钥是否有效

## 🎯 快速开始

1. **复制模板文件**：`cp env_template.txt .env`
2. **编辑配置**：修改 `.env` 文件中的配置
3. **启动系统**：`python start_with_env.py`
4. **访问系统**：打开 http://localhost:8501
