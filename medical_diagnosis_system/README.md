# 术前病情预测 & 中西医结合诊疗报告生成系统

一个基于 AI 的医疗辅助系统，能够根据病人信息生成中西医结合的术前诊疗报告。

## 🚀 功能特点

- **智能诊断**：基于 OpenAI GPT-4 生成专业的中西医结合诊疗报告
- **完整流程**：从病人信息录入到报告生成的一站式解决方案
- **多格式输出**：支持文本和 PDF 格式报告导出
- **历史管理**：完整的病人信息和报告历史记录管理
- **用户友好**：基于 Streamlit 的直观 Web 界面

## 🏗️ 技术架构

### 后端
- **FastAPI**：高性能 Python Web 框架
- **SQLite**：轻量级数据库存储
- **OpenAI GPT-4**：AI 报告生成引擎

### 前端
- **Streamlit**：快速构建的 Web 界面
- **响应式设计**：适配不同设备屏幕

### 报告生成
- **ReportLab**：专业 PDF 报告生成
- **多格式支持**：文本、PDF 格式输出

## 📋 系统要求

- Python 3.8+
- OpenAI API Key
- 8GB+ RAM（推荐）

## 🛠️ 安装和运行

### 1. 克隆项目
```bash
git clone <repository-url>
cd medical_diagnosis_system
```

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

### 3. 配置环境变量
创建 `.env` 文件：
```bash
OPENAI_API_KEY=your_openai_api_key_here
```

### 4. 启动后端服务
```bash
python main.py
```
后端服务将在 `http://127.0.0.1:8000` 启动

### 5. 启动前端界面
```bash
streamlit run app.py
```
前端界面将在 `http://localhost:8501` 启动

## 📖 使用指南

### 新增病人报告
1. 在"新增病人报告"页面填写病人基本信息
2. 输入主诉、既往病史等临床信息
3. 填写实验室检查结果和影像学检查
4. 选择报告类型（中西医结合/西医/中医）
5. 点击"生成诊疗报告"按钮
6. 查看生成的报告并下载

### 查看历史记录
1. 在"查看历史记录"页面浏览所有病人
2. 使用搜索功能快速定位特定病人
3. 点击病人查看详细信息和报告
4. 支持生成和下载 PDF 格式报告

### 系统设置
1. 在"系统设置"页面配置 OpenAI API Key
2. 查看系统版本和使用说明

## 📊 数据结构

### 病人信息模型
```json
{
  "name": "病人姓名",
  "age": 55,
  "sex": "男/女",
  "chief_complaint": "主诉",
  "history": "既往病史",
  "labs": {
    "ALT": 56,
    "AST": 62,
    "AFP": 420
  },
  "imaging": "影像学检查结果",
  "additional_notes": "其他备注"
}
```

### 报告结构
- 疾病分析（西医诊断 + 中医辨证）
- 术前风险评估
- 推荐检查项目
- 治疗方案（西医 + 中医）
- 注意事项

## 🔧 API 接口

### 生成报告
```http
POST /generate_report
Content-Type: application/json

{
  "patient": { ... },
  "report_type": "comprehensive"
}
```

### 获取病人列表
```http
GET /patients
```

### 获取病人详情
```http
GET /patient/{patient_id}
```

### 生成 PDF 报告
```http
POST /generate_pdf/{patient_id}
```

### 下载 PDF 文件
```http
GET /download_pdf/{filename}
```

## 🎯 核心特性

### 中西医结合诊断
- **西医分析**：基于现代医学理论进行疾病诊断
- **中医辨证**：运用中医理论进行证型分析
- **综合评估**：结合两种医学体系提供全面诊断

### 智能报告生成
- **结构化输出**：标准化的报告格式
- **专业术语**：使用准确的医学术语
- **个性化内容**：根据病人具体情况定制报告

### 风险评估
- **多维度评估**：年龄、检查指标、病史等
- **风险分级**：提供明确的风险等级评估
- **建议措施**：针对性的预防和治疗建议

## ⚠️ 重要声明

1. **仅供参考**：本系统生成的报告仅供医疗参考，不能替代专业医生的诊断
2. **数据安全**：请妥善保管病人隐私信息，遵守相关法律法规
3. **专业建议**：如有疑问请及时咨询专业医生
4. **持续更新**：系统会持续优化，建议定期更新

## 🔄 版本更新

### v1.0.0
- 基础功能实现
- 中西医结合报告生成
- PDF 导出功能
- 历史记录管理

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request 来改进这个项目。

## 📄 许可证

本项目采用 MIT 许可证。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 GitHub Issue
- 发送邮件至项目维护者

---

**免责声明**：本系统仅作为医疗辅助工具，所有诊断和治疗决策应由专业医生做出。
